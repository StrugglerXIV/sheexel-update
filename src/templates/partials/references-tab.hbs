<div class="sheexcel-sidebar-tab tab references" data-tab="references">
  <h3>References</h3>
  <button type="button" class="sheexcel-import-json">Import JSON…</button>
  <button type="button" class="sheexcel-export-json">Export JSON…</button>
  <input type="file" id="sheexcel-json-file" accept="application/json" style="display:none;">

  <div class="sheexcel-references">
    {{#each adjustedReferences}}
      <div class="sheexcel-reference-row" data-index="{{this.index}}">
        <!-- Cell, Keyword, Sheet, Type -->
        <input type="text"
               class="sheexcel-reference-input"
               data-type="cell"
               data-index="{{this.index}}"
               value="{{this.cell}}"
               placeholder="Bonus">
        <input type="text"
               class="sheexcel-reference-input"
               data-type="keyword"
               data-index="{{this.index}}"
               value="{{this.keyword}}"
               placeholder="Keyword">
        <select class="sheexcel-reference-input"
                data-type="sheet"
                data-index="{{this.index}}">
          {{#each this.sheetNames}}
            <option value="{{this}}" {{#if (eq this ../sheet)}}selected{{/if}}>{{this}}</option>
          {{/each}}
        </select>
        <select class="sheexcel-reference-input"
                data-type="refType"
                data-index="{{this.index}}">
          <option value="checks"  {{#if (eq this.type "checks")}}selected{{/if}}>Checks</option>
          <option value="saves"   {{#if (eq this.type "saves")}}selected{{/if}}>Saves</option>
          <option value="attacks" {{#if (eq this.type "attacks")}}selected{{/if}}>Attacks</option>
          <option value="spells"  {{#if (eq this.type "spells")}}selected{{/if}}>Spells</option>
        </select>

        {{!-- Additional inputs for attacks --}}
        {{#if (eq this.type "attacks")}}
          <input type="text"
                 class="sheexcel-reference-input"
                 data-type="attackNameCell"
                 data-index="{{this.index}}"
                 value="{{this.attackNameCell}}"
                 placeholder="Name Cell">
          <input type="text"
                 class="sheexcel-reference-input"
                 data-type="critRangeCell"
                 data-index="{{this.index}}"
                 value="{{this.critRangeCell}}"
                 placeholder="Crit Range Cell">
          <input type="text"
                 class="sheexcel-reference-input"
                 data-type="damageCell"
                 data-index="{{this.index}}"
                 value="{{this.damageCell}}"
                 placeholder="Damage Cell">
        {{/if}}

        <div class="sheexcel-reference-remove">
          <button type="button"
                  class="sheexcel-reference-remove-button"
                  data-index="{{this.index}}">Remove</button>
          <span class="sheexcel-reference-value">{{this.value}}</span>
        </div>
      </div>
    {{/each}}
  </div>

  <div class="sheexcel-references-controls">
    <button type="button" class="sheexcel-reference-save-button">Save References</button>
    <button type="button" class="sheexcel-reference-add-button">Add Reference</button>
  </div>
</div>
